<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' https://sketchfab.com https://maps.googleapis.com https://maps.gstatic.com https://maps.google.com https://generativelanguage.googleapis.com https://api.open-meteo.com; connect-src 'self' https://generativelanguage.googleapis.com https://api.open-meteo.com https://maps.googleapis.com; img-src 'self' data: https://*.googleapis.com https://*.gstatic.com https://*.google.com https://*.googleusercontent.com; frame-src https://sketchfab.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com https://fonts.googleapis.com; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://maps.googleapis.com;">
  <title>Helios</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/theme.css">
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/glass.css">
  <link rel="stylesheet" href="css/nav.css">
  <link rel="stylesheet" href="css/dashboard.css">
  <link rel="stylesheet" href="css/missions.css">
  <link rel="stylesheet" href="css/droneview.css">
  <link rel="stylesheet" href="css/reports.css">
  <link rel="stylesheet" href="css/animations.css">
</head>
<body>
  <!-- Titlebar (Electron custom) -->
  <div class="titlebar" id="titlebar">
    <div class="titlebar-drag"></div>
    <div class="titlebar-brand">
      <svg class="titlebar-logo" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M12 2L2 7l10 5 10-5-10-5z"/>
        <path d="M2 17l10 5 10-5"/>
        <path d="M2 12l10 5 10-5"/>
      </svg>
      <span class="titlebar-text">HELIOS</span>
    </div>
    <div class="titlebar-controls">
      <button class="theme-toggle" id="themeToggle" title="Toggle theme">
        <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="5"/>
          <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
        </svg>
        <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- 3D Model Background -->
  <div class="model-background" id="modelBackground">
    <iframe 
      title="Helios" 
      frameborder="0" 
      allowfullscreen 
      mozallowfullscreen="true" 
      webkitallowfullscreen="true" 
      allow="autoplay; fullscreen; xr-spatial-tracking" 
      xr-spatial-tracking 
      execution-while-out-of-viewport 
      execution-while-not-rendered 
      web-share 
      src="https://sketchfab.com/models/e28b781525074050b7a066b17b388ef5/embed?transparent=1&autostart=1&ui_stop=0&ui_inspector=0&ui_watermark=0&ui_watermark_link=0&ui_ar=0&ui_help=0&ui_settings=0&ui_vr=0&ui_fullscreen=0&ui_annotations=0&ui_infos=0">
    </iframe>
    <div class="model-overlay"></div>
  </div>

  <!-- Main Content -->
  <div class="app-container">
    <!-- Dashboard Content -->
    <main class="main-content" id="mainContent">
      <!-- Hero Section -->
      <div class="hero-section">
        <div class="hero-text">
          <h1 class="hero-title">
            <span class="hero-title-line">HELIOS</span>
            <span class="hero-subtitle">eVTOL Command Center</span>
          </h1>
          <p class="hero-description">Next-generation autonomous drone management platform for professional fleet operations.</p>
        </div>
      </div>

      <!-- Dashboard Action Pills -->
      <div class="dashboard-pills" id="dashboardPills">
        <button class="pill-card" data-action="support">
          <div class="pill-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"/>
            </svg>
          </div>
          <span class="pill-label">Support</span>
          <span class="pill-description">Get help from our team</span>
        </button>

        <button class="pill-card" data-action="documentation">
          <div class="pill-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"/>
            </svg>
          </div>
          <span class="pill-label">Documentation</span>
          <span class="pill-description">Explore guides & APIs</span>
        </button>

        <button class="pill-card" data-action="connect">
          <div class="pill-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m9.915-3.173a4.5 4.5 0 00-1.242-7.244l4.5-4.5a4.5 4.5 0 016.364 6.364l-1.757 1.757"/>
            </svg>
          </div>
          <span class="pill-label">Connect</span>
          <span class="pill-description">Link your drone fleet</span>
        </button>

        <button class="pill-card" data-action="join">
          <div class="pill-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M15.59 14.37a6 6 0 01-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 006.16-12.12A14.98 14.98 0 009.631 8.41m5.96 5.96a14.926 14.926 0 01-5.841 2.58m-.119-8.54a6 6 0 00-7.381 5.84h4.8m2.58-5.84a14.927 14.927 0 00-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 01-2.448-2.448 14.9 14.9 0 01.06-.312m-2.24 2.39a4.493 4.493 0 00-1.757 4.306 4.493 4.493 0 004.306-1.758M16.5 9a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/>
            </svg>
          </div>
          <span class="pill-label">Join</span>
          <span class="pill-description">Become a pilot</span>
        </button>
      </div>
    </main>

    <!-- Mission Planning Page -->
    <section class="page-section" id="pageMissions" style="display:none;">
      <div class="missions-container">
        <!-- Floating Mission Form (left side, collapsible) -->
        <div class="mission-form-panel" id="missionFormPanel">
          <div class="mission-form-header">
            <div class="mission-form-header-top">
              <div>
                <h2 class="mission-form-title">New Mission</h2>
                <p class="mission-form-subtitle">Configure your flight plan</p>
              </div>
              <button class="form-collapse-btn" id="btnCollapseForm" title="Collapse panel">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                  <path d="M15 19l-7-7 7-7"/>
                </svg>
              </button>
            </div>
          </div>

          <form class="mission-form" id="missionForm" autocomplete="off">
            <!-- Drone Model -->
            <div class="form-group">
              <label class="form-label" for="droneModel">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="14" height="14">
                  <path d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"/>
                  <path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                </svg>
                Drone Model
              </label>
              <div class="select-wrapper">
                <select id="droneModel" class="form-select" required>
                  <option value="" disabled selected>Select a model</option>
                  <option value="helios-x1">Helios X1 — Recon</option>
                  <option value="helios-h4">Helios H4 — Heavy Lift</option>
                  <option value="helios-s2">Helios S2 — Survey</option>
                </select>
                <svg class="select-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                  <path d="M6 9l6 6 6-6"/>
                </svg>
              </div>
            </div>

            <!-- Date of Take Off -->
            <div class="form-group">
              <label class="form-label" for="takeoffDate">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="14" height="14">
                  <path d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"/>
                </svg>
                Date of Take Off
              </label>
              <input type="datetime-local" id="takeoffDate" class="form-input" required>
            </div>

            <!-- Load Weight -->
            <div class="form-group">
              <label class="form-label" for="loadWeight">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="14" height="14">
                  <path d="M12 3v17.25m0 0c-1.472 0-2.882.265-4.185.75M12 20.25c1.472 0 2.882.265 4.185.75M18.75 4.97A48.416 48.416 0 0012 4.5c-2.291 0-4.545.16-6.75.47m13.5 0c1.01.143 2.01.317 3 .52m-3-.52l2.62 10.726c.122.499-.106 1.028-.589 1.202a5.988 5.988 0 01-2.031.352 5.988 5.988 0 01-2.031-.352c-.483-.174-.711-.703-.59-1.202L18.75 4.971zm-16.5.52c.99-.203 1.99-.377 3-.52m0 0l2.62 10.726c.122.499-.106 1.028-.589 1.202a5.989 5.989 0 01-2.031.352 5.989 5.989 0 01-2.031-.352c-.483-.174-.711-.703-.59-1.202L5.25 4.971z"/>
                </svg>
                Load Weight
              </label>
              <div class="weight-input-group">
                <input type="number" id="loadWeight" class="form-input" placeholder="0.0" min="0" step="0.1" required>
                <div class="unit-toggle" id="unitToggle">
                  <button type="button" class="unit-btn active" data-unit="kg">kg</button>
                  <button type="button" class="unit-btn" data-unit="lbs">lbs</button>
                </div>
              </div>
            </div>

            <!-- Mission Description -->
            <div class="form-group">
              <label class="form-label" for="missionDescription">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="14" height="14">
                  <path d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m.75 12l3 3m0 0l3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"/>
                </svg>
                Mission Description
              </label>
              <textarea id="missionDescription" class="form-input" placeholder="Enter mission details, objectives, and notes..." rows="3"></textarea>
            </div>

            <!-- Mission Summary (populated by waypoints) -->
            <div class="form-group">
              <label class="form-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="14" height="14">
                  <path d="M9 6.75V15m6-6v8.25m.503 3.498l4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 00-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0z"/>
                </svg>
                Route Summary
              </label>
              <div class="route-summary" id="routeSummary">
                <div class="route-stat">
                  <span class="route-stat-value" id="routeDistance">—</span>
                  <span class="route-stat-label">Distance</span>
                </div>
                <div class="route-stat">
                  <span class="route-stat-value" id="routeWaypoints">0</span>
                  <span class="route-stat-label">Waypoints</span>
                </div>
              </div>
            </div>

            <div class="mission-form-actions">
              <button type="submit" class="form-submit" id="btnStartMission">
                <svg class="submit-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                  <path d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"/>
                </svg>
                <span class="submit-label">Plan Mission</span>
                <div class="submit-spinner"></div>
              </button>
              <button type="button" class="form-submit form-submit-secondary" id="btnSimulateMission">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                  <path d="M5 3l14 9-14 9V3z"/>
                </svg>
                <span>Simulate Mission</span>
              </button>
            </div>
          </form>
        </div>

        <!-- Google Map -->
        <div class="map-wrapper">
          <div id="missionMap" class="mission-map"></div>

          <!-- Expand button (shown when form is collapsed) -->
          <button class="form-expand-btn" id="btnExpandForm" title="Open mission config">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
              <path d="M9 5l7 7-7 7"/>
            </svg>
          </button>

          <!-- Waypoint list overlay -->
          <div class="waypoint-bar" id="waypointBar">
            <div class="waypoint-bar-header">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="16" height="16">
                <path d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"/><path d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"/>
              </svg>
              <span>Waypoints</span>
              <span class="waypoint-count" id="waypointCount">0</span>
            </div>
            <div class="waypoint-list" id="waypointList">
              <div class="waypoint-empty">Click on the map to add waypoints</div>
            </div>
            <div class="waypoint-bar-actions">
              <button class="wp-action-btn" id="btnClearWaypoints" title="Clear all waypoints">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="15" height="15">
                  <path d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"/>
                </svg>
                Clear
              </button>
              <button class="wp-action-btn wp-action-primary" id="btnUndoWaypoint" title="Remove last waypoint">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="15" height="15">
                  <path d="M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"/>
                </svg>
                Undo
              </button>
            </div>
          </div>

          <!-- AI Loading Indicator (center of map) -->
          <div class="ai-loading-overlay" id="aiLoadingOverlay">
            <div class="ai-loading-card">
              <div class="loading-spinner"></div>
              <span>Planning mission...</span>
            </div>
          </div>

          <!-- AI Route Control Bar (top-center) -->
          <div class="ai-control-bar" id="aiControlBar">
            <div class="ai-control-left">
              <div class="ai-badge-sm">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="14" height="14"><path d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z"/></svg>
                AI Route
              </div>
              <div class="ai-legend">
                <span class="legend-item"><span class="legend-dot legend-user"></span>Your Route</span>
                <span class="legend-item"><span class="legend-dot legend-ai"></span>AI Optimized</span>
              </div>
            </div>
            <div class="ai-control-actions">
              <button class="ai-ctrl-btn ai-ctrl-dismiss" id="btnDismissAi">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><path d="M6 18L18 6M6 6l12 12"/></svg>
                Dismiss
              </button>
              <button class="ai-ctrl-btn ai-ctrl-replan" id="btnReplanAi">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><path d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182"/></svg>
                Re-plan
              </button>
              <button class="ai-ctrl-btn ai-ctrl-accept" id="btnAcceptAi">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><path d="M4.5 12.75l6 6 9-13.5"/></svg>
                Accept Route
              </button>
            </div>
          </div>

          <!-- Weather Panel (top-left floating) -->
          <div class="ai-weather-panel" id="aiWeatherPanel">
            <div class="ai-panel-header">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="16" height="16"><path d="M2.25 15a4.5 4.5 0 004.5 4.5H18a3.75 3.75 0 001.332-7.257 3 3 0 00-3.758-3.848 5.25 5.25 0 00-10.233 2.33A4.502 4.502 0 002.25 15z"/></svg>
              <span class="ai-panel-title">Weather at Launch</span>
              <button class="ai-panel-dismiss" id="btnCloseWeather" title="Close">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="12" height="12"><path d="M6 18L18 6M6 6l12 12"/></svg>
              </button>
            </div>
            <div class="ai-weather-body" id="aiWeatherBody"></div>
          </div>

          <!-- Pilot Briefing Panel (bottom-left floating) -->
          <div class="ai-briefing-panel" id="aiBriefingPanel">
            <div class="ai-panel-header">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="16" height="16"><path d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z"/></svg>
              <span class="ai-panel-title">Pilot Briefing</span>
              <span class="ai-risk-badge" id="aiBriefingRisk">--</span>
              <button class="ai-panel-dismiss" id="btnCloseBriefing" title="Close">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="12" height="12"><path d="M6 18L18 6M6 6l12 12"/></svg>
              </button>
            </div>
            <div class="ai-briefing-body" id="aiBriefingBody"></div>
          </div>

        </div>
      </div>

    </section>

    <!-- Drone View Page -->
    <section class="page-section" id="pageDroneView" style="display:none;">
      <div class="droneview-container">
        <!-- Map Area -->
        <div class="droneview-map-wrapper">
          <div id="droneviewMap" class="droneview-map"></div>

          <!-- Demo Data Badge -->
          <div class="dv-demo-badge">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="13" height="13">
              <path d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"/>
            </svg>
            <span>Simulated Data</span>
          </div>

          <!-- Live Badge -->
          <div class="dv-live-badge">
            <span class="dv-live-dot"></span>
            <span class="dv-live-label">Live</span>
            <span class="dv-drone-id">Helios X1 — HLX-0042</span>
          </div>

          <!-- AI Loading Overlay -->
          <div class="dv-loading-overlay" id="dvLoadingOverlay">
            <div class="ai-loading-card">
              <div class="loading-spinner"></div>
              <span>Analyzing flight...</span>
            </div>
          </div>

          <!-- Flight Analysis Panel (floating) -->
          <div class="dv-analysis-panel" id="dvAnalysisPanel">
            <div class="dv-analysis-header">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="16" height="16"><path d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z"/></svg>
              <span class="dv-analysis-title">AI Flight Analysis</span>
              <button class="dv-analysis-close" id="btnCloseAnalysis" title="Close">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="12" height="12"><path d="M6 18L18 6M6 6l12 12"/></svg>
              </button>
            </div>
            <div class="dv-analysis-body" id="dvAnalysisBody"></div>
          </div>

          <!-- Expand button (shown when panel is collapsed) -->
          <button class="dv-expand-btn" id="btnExpandTelemetry" title="Open flight data">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
              <path d="M9 5l7 7-7 7"/>
            </svg>
          </button>

          <!-- Mission Complete Overlay -->
          <div class="dv-mission-complete-overlay" id="dvMissionComplete">
            <div class="dv-mission-complete-card">
              <div class="dv-mc-check">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" width="32" height="32">
                  <path d="M4.5 12.75l6 6 9-13.5"/>
                </svg>
              </div>
              <h2 class="dv-mc-title">Mission Complete</h2>
              <p class="dv-mc-subtitle">The drone has successfully returned to the launch point. All waypoints were visited.</p>
              <div class="dv-mc-stats">
                <div class="dv-mc-stat">
                  <span class="dv-mc-stat-value" id="dvMcDuration">--</span>
                  <span class="dv-mc-stat-label">Duration</span>
                </div>
                <div class="dv-mc-stat">
                  <span class="dv-mc-stat-value" id="dvMcDistance">--</span>
                  <span class="dv-mc-stat-label">Distance</span>
                </div>
                <div class="dv-mc-stat">
                  <span class="dv-mc-stat-value" id="dvMcBattery">--</span>
                  <span class="dv-mc-stat-label">Battery Left</span>
                </div>
              </div>
              <div class="dv-mc-actions">
                <button class="dv-mc-btn dv-mc-btn-secondary" id="btnRestartMission">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                    <path d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182"/>
                  </svg>
                  Restart
                </button>
                <button class="dv-mc-btn dv-mc-btn-primary" id="btnViewReport">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                    <path d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"/>
                  </svg>
                  View Flight Report
                </button>
              </div>
            </div>
          </div>

          <!-- AI Route Control Bar -->
          <div class="dv-ai-route-bar" id="dvRouteBar">
            <div class="ai-badge-sm">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="14" height="14"><path d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z"/></svg>
              Alt Routes
            </div>
            <div class="ai-legend">
              <span class="legend-item"><span class="legend-dot legend-current"></span>Current Route</span>
              <span class="legend-item"><span class="legend-dot legend-alt"></span>AI Alternative</span>
            </div>
            <div class="dv-ai-route-bar-actions">
              <button class="dv-route-ctrl-btn dv-route-dismiss" id="btnDismissRoutes">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><path d="M6 18L18 6M6 6l12 12"/></svg>
                Dismiss
              </button>
              <button class="dv-route-ctrl-btn dv-route-accept" id="btnAcceptRoute">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><path d="M4.5 12.75l6 6 9-13.5"/></svg>
                Accept Route
              </button>
            </div>
          </div>

        </div>

        <!-- Telemetry Sidebar (left, collapsible) -->
        <div class="dv-telemetry-panel" id="dvTelemetryPanel">
          <div class="dv-panel-collapse-header">
            <div class="dv-panel-collapse-title">
              <h2>Flight Data</h2>
              <p>Live telemetry feed</p>
            </div>
            <button class="dv-collapse-btn" id="btnCollapseTelemetry" title="Collapse panel">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                <path d="M15 19l-7-7 7-7"/>
              </svg>
            </button>
          </div>
          <!-- Mission Progress -->
          <div class="dv-progress-section">
            <div class="dv-progress-header">
              <span class="dv-progress-label">Mission Progress</span>
              <span class="dv-progress-value" id="dvProgressPct">0%</span>
            </div>
            <div class="dv-progress-track">
              <div class="dv-progress-fill" id="dvProgressFill" style="width:0%"></div>
            </div>
          </div>

          <!-- Telemetry -->
          <div class="dv-panel-section">
            <div class="dv-section-header">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="16" height="16"><path d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"/></svg>
              <span class="dv-section-title">Telemetry</span>
            </div>
            <div class="dv-telemetry-grid" id="dvTelemetryGrid">
              <div class="dv-telem-card">
                <span class="dv-telem-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="18" height="18"><path d="M3 17l6-6 4 4 8-8"/><path d="M17 7h4v4"/></svg></span>
                <span class="dv-telem-value" id="dvAltitude">0</span>
                <span class="dv-telem-label">Altitude <span class="dv-telem-unit">m</span></span>
              </div>
              <div class="dv-telem-card">
                <span class="dv-telem-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="18" height="18"><path d="M12 12l3.5-3.5M6.3 17.7a9 9 0 1111.4 0"/></svg></span>
                <span class="dv-telem-value" id="dvSpeed">0</span>
                <span class="dv-telem-label">Speed <span class="dv-telem-unit">km/h</span></span>
              </div>
              <div class="dv-telem-card">
                <span class="dv-telem-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="18" height="18"><circle cx="12" cy="12" r="9"/><path d="M16.24 7.76l-2.12 6.36-6.36 2.12 2.12-6.36 6.36-2.12z"/></svg></span>
                <span class="dv-telem-value" id="dvHeading">0°</span>
                <span class="dv-telem-label">Heading</span>
              </div>
              <div class="dv-telem-card">
                <span class="dv-telem-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="18" height="18"><path d="M9.348 14.652a3.75 3.75 0 010-5.304m5.304 0a3.75 3.75 0 010 5.304m-7.425 2.121a6.75 6.75 0 010-9.546m9.546 0a6.75 6.75 0 010 9.546M5.106 18.894c-3.808-3.808-3.808-9.98 0-13.788m13.788 0c3.808 3.808 3.808 9.98 0 13.788M12 12h.008v.008H12V12zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"/></svg></span>
                <span class="dv-telem-value" id="dvSatellites">0</span>
                <span class="dv-telem-label">Satellites</span>
              </div>
              <div class="dv-telem-card wide">
                <span class="dv-telem-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="18" height="18"><rect x="2" y="7" width="18" height="10" rx="2"/><path d="M22 11v2"/></svg></span>
                <span class="dv-telem-value" id="dvBattery">100%</span>
                <span class="dv-telem-label">Battery</span>
                <div class="dv-battery-bar">
                  <div class="dv-battery-fill high" id="dvBatteryFill" style="width:100%"></div>
                </div>
              </div>
              <div class="dv-telem-card">
                <span class="dv-telem-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="18" height="18"><path d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"/><path d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"/></svg></span>
                <span class="dv-telem-value small" id="dvLat">0.00000</span>
                <span class="dv-telem-label">Latitude</span>
              </div>
              <div class="dv-telem-card">
                <span class="dv-telem-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="18" height="18"><path d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"/><path d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"/></svg></span>
                <span class="dv-telem-value small" id="dvLng">0.00000</span>
                <span class="dv-telem-label">Longitude</span>
              </div>
            </div>
          </div>

          <!-- Weather -->
          <div class="dv-panel-section">
            <div class="dv-section-header">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="16" height="16"><path d="M2.25 15a4.5 4.5 0 004.5 4.5H18a3.75 3.75 0 001.332-7.257 3 3 0 00-3.758-3.848 5.25 5.25 0 00-10.233 2.33A4.502 4.502 0 002.25 15z"/></svg>
              <span class="dv-section-title">Live Weather</span>
            </div>
            <div class="dv-weather-grid" id="dvWeatherGrid">
              <div class="dv-weather-card wide">
                <span class="dv-weather-icon" id="dvWeatherIcon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="20" height="20"><path d="M12 3v2m0 14v2m9-9h-2M5 12H3m15.364 6.364l-1.414-1.414M7.05 7.05L5.636 5.636m12.728 0l-1.414 1.414M7.05 16.95l-1.414 1.414M12 8a4 4 0 100 8 4 4 0 000-8z"/></svg></span>
                <span class="dv-weather-value" id="dvWeatherCondition">Clear Sky</span>
                <span class="dv-weather-label">Conditions</span>
              </div>
              <div class="dv-weather-card">
                <span class="dv-weather-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="18" height="18"><path d="M12 9v6m-3-3h6M12 3a9 9 0 100 18 9 9 0 000-18z"/></svg></span>
                <span class="dv-weather-value" id="dvWeatherTemp">—</span>
                <span class="dv-weather-label">Temp</span>
              </div>
              <div class="dv-weather-card">
                <span class="dv-weather-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="18" height="18"><path d="M3.5 12h17M3.5 8h13M3.5 16h10"/></svg></span>
                <span class="dv-weather-value" id="dvWeatherWind">—</span>
                <span class="dv-weather-label" id="dvWeatherWindDir">Wind</span>
              </div>
              <div class="dv-weather-card">
                <span class="dv-weather-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="18" height="18"><path d="M2.25 15a4.5 4.5 0 004.5 4.5H18a3.75 3.75 0 001.332-7.257 3 3 0 00-3.758-3.848 5.25 5.25 0 00-10.233 2.33A4.502 4.502 0 002.25 15z"/></svg></span>
                <span class="dv-weather-value" id="dvWeatherRain">—</span>
                <span class="dv-weather-label">Rain</span>
              </div>
              <div class="dv-weather-card">
                <span class="dv-weather-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="18" height="18"><path d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"/><path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg></span>
                <span class="dv-weather-value" id="dvWeatherVis">—</span>
                <span class="dv-weather-label">Visibility</span>
              </div>
            </div>
          </div>

          <!-- Waypoints -->
          <div class="dv-panel-section">
            <div class="dv-section-header">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="16" height="16"><path d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"/><path d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"/></svg>
              <span class="dv-section-title">Waypoints</span>
            </div>
            <div class="dv-wp-list" id="dvWaypointList"></div>
          </div>

          <!-- AI Actions -->
          <div class="dv-panel-section">
            <div class="dv-section-header">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="16" height="16"><path d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z"/></svg>
              <span class="dv-section-title">AI Assistant</span>
              <span class="dv-ai-badge">Gemini</span>
            </div>
            <div class="dv-ai-actions">
              <button class="dv-ai-btn dv-ai-btn-primary" id="btnFlightAnalysis">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="16" height="16"><path d="M3.75 3v11.25A2.25 2.25 0 006 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0118 16.5h-2.25m-7.5 0h7.5m-7.5 0l-1 3m8.5-3l1 3m0 0l.5 1.5m-.5-1.5h-9.5m0 0l-.5 1.5"/></svg>
                <span class="dv-ai-btn-label">Request Flight Analysis</span>
                <div class="dv-ai-btn-spinner"></div>
              </button>
              <button class="dv-ai-btn dv-ai-btn-secondary" id="btnAltRoutes">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="16" height="16"><path d="M9 6.75V15m6-6v8.25m.503 3.498l4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 00-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0z"/></svg>
                <span class="dv-ai-btn-label">Get Alternative Routes</span>
                <div class="dv-ai-btn-spinner"></div>
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Reports Page -->
    <section class="page-section" id="pageReports" style="display:none;">
      <div class="reports-container" id="reportsContent">
        <!-- Content dynamically rendered by Reports module -->
      </div>
    </section>

    <!-- Right Navigation Bar -->
    <nav class="nav-bar" id="navBar">
      <div class="nav-pill">
        <button class="nav-item active" data-page="dashboard" data-tooltip="Dashboard">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"/>
          </svg>
        </button>
        <button class="nav-item" data-page="missions" data-tooltip="Mission Planning">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M9 6.75V15m6-6v8.25m.503 3.498l4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 00-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0z"/>
          </svg>
        </button>
        <button class="nav-item" data-page="droneview" data-tooltip="Drone View">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"/>
            <path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
          </svg>
        </button>
        <button class="nav-item" data-page="reports" data-tooltip="Reports">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"/>
          </svg>
        </button>
      </div>
    </nav>
  </div>

  <script src="../../node_modules/chart.js/dist/chart.umd.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
